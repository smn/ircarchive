{% extends "base.html" %}
{% block body %}
    <h1>{{channel.channel}} on {{channel.server}}</h1>
    <a href="/">&larr; back to all channels</a>
    &middot;
    <a href="#latest">&darr; Latest messages at the bottom</a>
    <table>
        <tr>
            <th>Time</th>
            <th>User</th>
            <th>Message</th>
        </tr>
        {% if messages %}
            {% for message in messages %}
                {% ifequal message.message_type 'message' %}
                <tr class="{% cycle even,odd %}">
                    <td id="{{message.timestamp|date:"YmdHis"}}">{{message.timestamp|timesince}} ago</td>
                    <td class="white" style="background-color: rgb({{message.user.get_color|join:","}})">{{message.user.nickname}}</td>
                    <td>{{ message.message_content|escape|urlize }}</td>
                </tr>
                {% endifequal %}
        
                {% ifequal message.message_type 'action'  %}
                <tr class="action">
                    <td id="{{message.timestamp|date:"YmdHis"}}">{{message.timestamp|timesince}} ago</td>
                    <td></td>
                    <td>{{ message.message_content|escape|urlize }}</td>
                </tr>
                {% endifequal %}

                {% ifequal message.message_type 'system'  %}
                <tr class="system">
                    <td id="{{message.timestamp|date:"YmdHis"}}">{{message.timestamp|timesince}} ago</td>
                    <td></td>
                    <td>{{ message.message_content|escape|urlize }}</td>
                </tr>
                {% endifequal %}
            {% endfor %}
        {% else %}
            <tr>
                <td colspan="3">No messages were posted today</td>
            </tr>
        {% endif %}
        <tr>
            <td colspan="3" id="latest">
                {% if has_next_page %}
                    <div class="next">
                        <a href="?p={{ next_page_no }}">Next &rarr;</a>
                    </div>
                {% endif %}
                {% if has_prev_page %}
                    <div class="previous">
                        <a href="?p={{ prev_page_no }}">&larr; Previous</a>
                    </div>
                {% endif %}
            </td>
        </tr>
    </table>
{% endblock %}
